<section class="section" data-channel-subcribe="room" data-room-id="<%= @room.id%>" data-user-id="<%= current_user.id %>">
  <div class="row">
    <div class="columns">
      <div class="column is-one-third">
        <%= render 'rooms/room-list'%>
      </div>
      <div class="column is-two-third">
        <div class="columns">
          <div class="column is-two-third has-text-centered">
            <strong><%= @room.name %></strong>
          </div>
          <div class="column is-one-third">
            <%= link_to "leave", room_roomusers_path(@room), method: :delete %>
          </div>
        </div>
        <div id="chat_list">
          <% if @room.chats.present? %>
          <% @room.chats.order(created_at: :asc).last(10).each do |c| %>
          <% if c.user_id == current_user.id %>
          <div class="column is-7 is-offset-5">
            <p class="notification is-primary conversation-message"  >
              <%= c.text %>
            </p>
            <span class="subtitle is-7"><%= time_ago_in_words(c.created_at )%></span>
          </div>
          <% else %>
          <div class="column is-7">
            <article class="media">
              <div class="media-left">
                <figure class="image is-32x32">
                  <%= image_tag avatar_url(c.user), class: "is-rounded"%>
                </figure>
              </div>
              <div class="media-content">
                <p class="notification conversation-message" >
                  <%= c.text %>
                </p>
              </div>

            </article>
          </div>
          <% end %>
          <% end %>
          <% else %>
          <p> Be the first to chat</p>
          <% end %>
        </div>
          <div class="chat-form">
            <%= form_for [@room, Chat.new], remote: :true, id: 'new_chat' do |f|%>
            <%= f.text_field :text, class: 'input'%>
            <%= f.submit "Send", class: 'button is-warning'%>
            <% end %>
          </div>
      </div>
    </div>
  </div>
</section>
